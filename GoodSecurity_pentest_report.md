# Pentesting Report

For this red-team exercise, I was tasked with finding vulnerabilities in a Windows 10 machine, compromise the machine and escalate my privileges. 

GoodSecurity is a fictionnal company, however, the target machine is a real-life updated Windows 10 machine. Below you will find additional details regarding the lab environment used for this pentest.

## High-Level Summary

I was tasked with performing an internal penetration test on GoodCorp’s CEO, Hans Gruber. 

An internal penetration test is a dedicated attack against internally connected systems. 
The focus of this test is to perform attacks, similar to those of a hacker and attempt to infiltrate Hans’ computer and determine if it is at risk. 
My overall objective was to exploit any vulnerable software and find the secret recipe file on Hans’ computer, while reporting the findings back to GoodCorp.

When performing the internal penetration test, there were several alarming vulnerabilities that I identified on Hans’ desktop. 
When performing the attacks, I was able to gain access to his machine and find the secret recipe file by exploiting two programs that had major vulnerabilities. 

The details of the attack can be found in the ‘Findings’ category.


## Findings

Machine IP:
`192.168.0.20`
Hostname:
`MSEDGEWIN10`

### Vulnerability Exploited #1

Icecast Multimedia webserver.

I used the following exploit module from Metasploit:

```bash
Exploit/windows/http/icecast_header
```

#### Vulnerability Explanation:

This vulnerability is a locally-exploitable buffer overflow. 

The issue resides in the XSL parser not checking the size of XSL ‘when’, ‘if’, and ‘value-of’ tag values before copying them into a finite buffer in process memory.

This attack is a remote code execution attack. It leverages the buffer-overflow vulnerability to execute arbitrary code on the machine.

Buffers are memory storage regions and their mission is to hold data temporarily while it is transferred to another location. A buffer-overflow is when the volume of data that is supposed to be stored in the memory buffer exceeds its capacity.

If attackers know the memory layout of a program, they can feed an excess of data to that memory buffer in order to overwrite areas of the memory that hold executable code, replacing that executable code with their own code. Attackers can now craft payloads that will be sent to that part of the memory that executes code and have their own malicious payload executed on the victim’s system.

#### Severity:

This vulnerability is extremely severe, it took me just a few minutes to remotely execute arbitrary code on the target machine and gain remote access to it.

#### Proof of Concept:

1. Service and version scan using Nmap to determine which services are up and running:

Nmap command that performs a service and version scan against the target.

```bash
nmap -sV 192.168.0.20
```

![nmap -sV scan](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/nmap_sV_scan.png)


2. From the previous step, I found that the Icecast service is running. This server software for streaming media is notorious for its vulnerabilities. 

So I decided to start attacking this server using `Metasploit`.


I ran the SearchSploit commands to show available Icecast exploits:

```bash
searschsploit icecast
```

![nmap -sV scan](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/searchsploit_icecast.png)


3. Now that I know which exploits are available, let's start Metasploit with the following command:

```bash
msfconsole
```

