To perform the following reconnaissance demonstration, I will use IBM's "Altoro Mutual" website located at `demo.testfire.net`. This website was designed by IBM to detect web application vulnerabilities.

I will use widely available open-source tools to perform all reconnaissance tasks.


## Google Dorking


The amount of information freely available on the open internet is astonishing. In this section I will use Google to gather important data about Altoro Mutual and will go over how this data can be weaponized by malicious actors.


### Finding the company's Executive Team

Altoro Mutual's website does not display the name of their executive members. The company wants to ensure that private information about their executive and upper management team is not accessible on their public website. 

By simply searching for “altoro mutual ceo” in the google search bar, I was able to quickly find the name of the CEO, Karl Fitzgerald. But more alarming is the fact that I was able to quickly find the following web page: http://www.altoromutual.com/index.jsp?content=inside_executives.htm (screenshot below).

![altoro mutual website](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/altoro_mutual_exec_members_webpage.png)

Since Altoro Mutual wants to ensure that private information is not accessible on their public website, the previous webpage is definitely an issue for the company as it lists the entire C-Suite and upper management teams.

### How can this information be helpful to an attacker:
 
- An attacker with the list of the C suite and/or upper management can start to use the names to start a social engineering attack on other employees of the company.
- An attacker can use the names to do more research and figure out the emails of the C suite team and start a Spear Phishing campaign targeting them.
- An attacker can Spoof the CEO or CFO and initiate unauthorized money wire transfer for example. This type of attack falls into the BEC schemes (Business Email Compromise).
- Other attacks on the C Suite team can include impersonating one of the C Suite members to gain access to sensitive information, grant access to a fake employee, transfer confidential data etc.


## DNS and Domain Discovery
 
In this section I used Domain Dossier which is a tool that generates reports from public records about domain names and IP addresses.

Next I entered the IP address for `demo.testfire.net` into Domain Dossier to gather the following information about the company:
 
 
1. Location of the company: 
 
From the Domain WHOIS record:
 
The company is located in Sunnyvale, California 94085, USA.
 
2. NetRange IP address:
 
65.61.137.64 - 65.61.137.127
 
CIDR: 65.61.137.64/26 
 
3. Company they use to store their infrastructure:
 
Rackspace Backbone Engineering
  
4. IP address of the DNS server:
 
65.61.137.117


![domain_dossier](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/domain_dossier_altoro_lookup.png)


## Shodan

Next, I used Shodan to scan the company's IP address.
 
Upon scanning the ip address of the server, Shodan found the following open ports and services:
 
`Port 80`: Running Apache Tomcat/Coyote JSP Engine version 1.1 web server.

`Port 443`: Open but with no apparent service running.

`Port 8080`: Running Apache Tomcat/Coyote JSP Engine version 1.1 web server.


## Recon-ng
 
Using the `xssed` module from Recon-ng, I scanned the company's domain looking for potential XSS vulnerabilities. Upon completion, Recon-ng found an unfixed XSS vulnerability, as seen below:

![recon-ng](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/XSS_Vulnerabilities.png)


![recon-ng](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/Altoro_Mutual_Vulnerability_report_.png)



## Zenmap
 
Zenmap is the GUI version of the famous tool `nmap`. In this section I will use it to demonstrate how to use the tool for reconnaissance.

I used the following IP address simulating a vulnerable file-sharing server that I set up locally:

IP address: `192.168.0.10`

I used the the following command to run a service scan against the vulnerable file-sharing server:

```bash
Nmap -sV -T4 -F 192.168.0.10
```

I ran an aggressive scan of the 100 most common ports with service versions of any running services, and below is the result of the above scan:


![zen map](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/Zenmap_Service-scan_result.png)

Following the scan I noticed that SMB services are running on ports 139 and 445. SMB is notorious for being vulnerable to many attacks. Now depending on the version of the SMB service, the server may or may not be vulnerable. To figure it out I used the built-in script `smb-vuln-*` to scan port 139 and 445 for any existing vulnerabilities.

I used the following command:

```bash
Nmap -p 139,445 --script smb-vuln-* --script-args unsafe1 192.168.0.10
```

![zen map](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/first_vuln_check.png)


I couldn’t identify any vulnerabilities tied to the SMB protocol.
 
I decided to run more tests running a couple scripts at the same time and had the output sent into an HTML file for better clarity (2 parts screenshot as I couldn’t make my Kali VM window bigger for some reason):


![zen map](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/html_scan_report_1.png)


You can see the command I used to run all the scripts at the same time under “Scan Summary” above.


![zen map](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment/blob/main/images/html_scan_report_2.png)


I used the `-oX` flag to generate an .XML file and then ran the following command to convert it into an .HTML file:


```bash
xsltproc smb_zenmap_vulnscan.xml -o smb_zenmap_vulnscan.html
```

Following the last scan, I found a vulnerability that could be exploited, below, a breakdown of the vulnerability and how it could be exploited.


### Vulnerability:
 
I found open network shares via the ‘smb-enum-shares’ script. Among them I found the network share IPC$ with READ/WRITE access as well as READ/WRITE access to C:\tmp. 
 
### Why is it dangerous:
 
It is dangerous because malicious actors may use valid accounts to connect and interact with remote network shares using SMB. 

If the shares are not protected by credentials and READ/WRITE is allowed to Anonymous users, then a malicious actor could interact with the file/folders remotely to move laterally throughout a network or drop a Trojan or infect a file that’s already there to enable more persistence into the network.
 
My scan returned access to the tmp folder and IPC$ share is allowed to the NULL user (output: `Anonymous access: READ/WRITE`), the NULL user in windows is a pseudo-account that has no username or password. This is a real threat and a malicious actor has clearly easy remote access to the vulnerable system. 
 
### Mitigation:
 
A few mitigation strategies exist as described by MITRE:
 
- Consider using the host firewall to restrict file sharing communication such as SMB.
- Do not allow NULL user access to network shares.
- Disable Windows administrative shares.
- Do not reuse local administrator account passwords across systems. Make sure passwords are long enough to resist brute-force attacks.
- Deny remote use of local admin credentials to log into systems. Do not allow domain user accounts to be in the local Administrators group multiple systems.
- Ensure that proper logging of accounts used to log into systems is turned on and centrally collected
- Monitor remote login events and associated SMB activity for file transfers and remote process execution
- Monitor for use of tools and commands to connect to remote shares, such as Net, on the command-line interface and Discovery techniques that could be used to find remotely accessible systems.



